# Resets and tests hash value set properly and not hashed to something else
import hashlib
import redis
hash = '5e884898da28047151d0e56f8dc6292773603d0d6aabbdd62a11ef721d1542d8'
r = redis.Redis(host='54.184.2.15',port=6379, username='default', password='password')
assert r.acl_setuser(username='jamie', enabled=True, reset=True,
                     add_passwords=[hash])

acl = r.acl_getuser(username='jamie')
assert acl['passwords'] == [hash]
# test remove_passwords for hash removal
assert r.acl_setuser(username='jamie', enabled=True, reset=True,
                             add_passwords=[hash, 'pass1'])
assert len(r.acl_getuser(username='jamie')['passwords']) == 2
assert r.acl_setuser(username='jamie', enabled=True,
                             remove_passwords=[hash])
assert len(r.acl_getuser(username='jamie')['passwords']) == 1
